<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>TEST Controller Inline</title>
</head>
<body>
  <h2>TEST Controller Inline</h2>
  <div>
    <label>Host IDï¼š</label>
    <input id="hostIdInput" value="ktv-host"/>
    <button onclick="connectHost()">é€£ç·š</button>
  </div>
  <div id="connStatus">å°šæœªé€£ç·š</div>

  <!-- PeerJS -->
  <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
  <script>
    function connectHost(){
      const hostId = document.getElementById("hostIdInput").value || "ktv-host";
      const myName = "TESTç”¨æˆ¶";

      let peer = new Peer(null, { 
        host: "0.peerjs.com",
        port: 443,
        path: "/",
        secure: true
      });

      peer.on("open", id=>{
        const conn = peer.connect(hostId);
        conn.on("open", ()=>{
          document.getElementById("connStatus").innerText="âœ… å·²é€£ç·šåˆ° Host: " + hostId;
          conn.send({type:"register", name:myName});
        });
        conn.on("data", msg=>console.log("ğŸ“© æ”¶åˆ° Host è¨Šæ¯:", msg));
        conn.on("close", ()=> document.getElementById("connStatus").innerText="âŒ èˆ‡ Host æ–·ç·š");
      });

      peer.on("error", err=>{
        document.getElementById("connStatus").innerText="âŒ PeerJS éŒ¯èª¤: "+err;
        console.error(err);
      });
    }
  </script>
</body>
</html>
